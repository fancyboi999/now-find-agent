# ğŸ“ FastAPI Scaffold é¡¹ç›®ç»“æ„

## ğŸ—ï¸ é¡¹ç›®æ¦‚è§ˆ

FastAPI Scaffold æ˜¯ä¸€ä¸ªç°ä»£åŒ–ã€ä¼ä¸šçº§çš„ Python Web API è„šæ‰‹æ¶ï¼Œé‡‡ç”¨æœ€æ–°çš„é¡¹ç›®ç®¡ç†å’Œå¼€å‘å®è·µã€‚

```
fastapi-scaffold/
â”œâ”€â”€ ğŸ“‹ é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ pyproject.toml          # ç°ä»£åŒ–é¡¹ç›®é…ç½®ï¼ˆPEP 518ï¼‰
â”‚   â”œâ”€â”€ .env.example            # ç¯å¢ƒé…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ .gitignore              # Git å¿½ç•¥æ–‡ä»¶
â”‚   â”œâ”€â”€ Makefile                # é¡¹ç›®ç®¡ç†å‘½ä»¤
â”‚   â””â”€â”€ setup.sh                # è‡ªåŠ¨åŒ–å®‰è£…è„šæœ¬
â”œâ”€â”€ ğŸŒ ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ .env                    # åŸºç¡€ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ .env.dev                # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ .env.test               # æµ‹è¯•ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ .env.uat                # UATç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ .env.prod               # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ switch-env.sh           # ç¯å¢ƒåˆ‡æ¢å·¥å…·
â”œâ”€â”€ ğŸ›ï¸ åº”ç”¨æ¶æ„
â”‚   â”œâ”€â”€ app/                    # åº”ç”¨æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”œâ”€â”€ api/                # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ providers/          # æœåŠ¡æä¾›è€…
â”‚   â”‚   â”‚   â”œâ”€â”€ app_provider.py    # åº”ç”¨æä¾›è€…
â”‚   â”‚   â”‚   â”œâ”€â”€ database/          # æ•°æ®åº“æä¾›è€…
â”‚   â”‚   â”‚   â”œâ”€â”€ exception_provider.py # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ logging_provider.py   # æ—¥å¿—æä¾›è€…
â”‚   â”‚   â”œâ”€â”€ schemas/            # Pydantic æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ config.py           # å¤šç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ bootstrap/              # åº”ç”¨å¯åŠ¨
â”‚       â””â”€â”€ application.py      # åº”ç”¨å·¥å‚
â”œâ”€â”€ ğŸ“– æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md               # é¡¹ç›®è¯´æ˜
â”‚   â”œâ”€â”€ database-examples.md    # æ•°æ®åº“é…ç½®ç¤ºä¾‹
â”‚   â”œâ”€â”€ multi-environment-guide.md # å¤šç¯å¢ƒæŒ‡å—
â”‚   â””â”€â”€ PROJECT_STRUCTURE.md   # é¡¹ç›®ç»“æ„è¯´æ˜
â”œâ”€â”€ ğŸ§ª æµ‹è¯•
â”‚   â””â”€â”€ tests/                  # æµ‹è¯•ä»£ç 
â””â”€â”€ ğŸ“ å…¶ä»–
    â”œâ”€â”€ main.py                 # åº”ç”¨å…¥å£
    â””â”€â”€ requirements.txt        # ä¼ ç»Ÿä¾èµ–æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
```

## ğŸ”§ æ ¸å¿ƒç‰¹æ€§

### 1. ç°ä»£åŒ–é¡¹ç›®ç®¡ç†
- âœ… **pyproject.toml** - ç¬¦åˆ PEP 518 æ ‡å‡†çš„é¡¹ç›®é…ç½®
- âœ… **uv** - å¿«é€Ÿçš„ Python åŒ…ç®¡ç†å™¨
- âœ… **åˆ†ç»„ä¾èµ–** - æŒ‰åŠŸèƒ½ç»„ç»‡ä¾èµ–ï¼ˆdevã€databaseã€aiç­‰ï¼‰
- âœ… **å¼€å‘å·¥å…·é›†æˆ** - Blackã€isortã€pytestã€mypy ç­‰

### 2. å¤šç¯å¢ƒæ”¯æŒ
- âœ… **å››ç¯å¢ƒæ¶æ„** - devã€testã€uatã€prod
- âœ… **ç¯å¢ƒéš”ç¦»** - æ¯ä¸ªç¯å¢ƒç‹¬ç«‹é…ç½®
- âœ… **æ™ºèƒ½åˆ‡æ¢** - ä¸€é”®ç¯å¢ƒåˆ‡æ¢å·¥å…·
- âœ… **é…ç½®ç®¡ç†** - Pydantic Settings é©±åŠ¨

### 3. å¤šæ•°æ®åº“æ”¯æŒ
- âœ… **ä¸‰å¤§æ•°æ®åº“** - SQLiteã€PostgreSQLã€MySQL
- âœ… **æ™ºèƒ½æ£€æµ‹** - è‡ªåŠ¨è¯†åˆ«æ•°æ®åº“ç±»å‹
- âœ… **å¼‚æ­¥ä¼˜å…ˆ** - æ‰€æœ‰æ•°æ®åº“æ“ä½œå¼‚æ­¥åŒ–
- âœ… **è¿æ¥ä¼˜åŒ–** - é’ˆå¯¹ä¸åŒæ•°æ®åº“ä¼˜åŒ–è¿æ¥å‚æ•°

### 4. ä¼ä¸šçº§æ¶æ„
- âœ… **Provider æ¨¡å¼** - æ¨¡å—åŒ–æœåŠ¡æä¾›è€…
- âœ… **ä¾èµ–æ³¨å…¥** - æ¸…æ™°çš„ä¾èµ–ç®¡ç†
- âœ… **å¼‚æ­¥æ¶æ„** - å…¨é¢çš„å¼‚æ­¥æ”¯æŒ
- âœ… **å¯æ‰©å±•è®¾è®¡** - æ˜“äºæ·»åŠ æ–°åŠŸèƒ½

## ğŸ“¦ ä¾èµ–ç®¡ç†

### æ ¸å¿ƒä¾èµ– (å¿…éœ€)
```toml
[project.dependencies]
fastapi>=0.110.0          # Web æ¡†æ¶
uvicorn[standard]>=0.25.0 # ASGI æœåŠ¡å™¨
pydantic>=2.5.0           # æ•°æ®éªŒè¯
sqlalchemy[asyncio]>=2.0.0 # ORM
redis>=5.0.0              # ç¼“å­˜
loguru>=0.7.0             # æ—¥å¿—
```

### å¯é€‰ä¾èµ–ç»„
```bash
# æ•°æ®åº“é©±åŠ¨
pip install fastapi-scaffold[database]

# AI/LLM åŠŸèƒ½
pip install fastapi-scaffold[ai]

# å¼€å‘å·¥å…·
pip install fastapi-scaffold[dev]

# ç”Ÿäº§éƒ¨ç½²
pip install fastapi-scaffold[production]

# å®Œæ•´å®‰è£…
pip install fastapi-scaffold[all]
```

## ğŸ› ï¸ å¼€å‘å·¥å…·

### é¡¹ç›®ç®¡ç†å‘½ä»¤
```bash
make help          # æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤
make install-dev   # å®‰è£…å¼€å‘ä¾èµ–
make dev           # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
make test          # è¿è¡Œæµ‹è¯•
make format        # æ ¼å¼åŒ–ä»£ç 
make lint          # ä»£ç æ£€æŸ¥
```

### ç¯å¢ƒåˆ‡æ¢
```bash
./switch-env.sh dev    # å¼€å‘ç¯å¢ƒ
./switch-env.sh test   # æµ‹è¯•ç¯å¢ƒ
./switch-env.sh uat    # UATç¯å¢ƒ
./switch-env.sh prod   # ç”Ÿäº§ç¯å¢ƒ
```

### å¿«é€Ÿåˆå§‹åŒ–
```bash
./setup.sh         # äº¤äº’å¼é¡¹ç›®è®¾ç½®
make init          # å¿«é€Ÿåˆå§‹åŒ–
```

## ğŸ—ï¸ Provider æ¶æ„

### å‘½åè§„èŒƒ
- âœ… **ç»Ÿä¸€å‘½å** - æ‰€æœ‰ provider ä½¿ç”¨ `xxx_provider.py` æ ¼å¼
- âœ… **æ¸…æ™°å¯¼å…¥** - ç®€åŒ–çš„å¯¼å…¥è·¯å¾„
- âœ… **åŠŸèƒ½åˆ†ç¦»** - æ¯ä¸ª provider èŒè´£å•ä¸€

### Provider åˆ—è¡¨
| Provider | åŠŸèƒ½ | æ–‡ä»¶è·¯å¾„ |
|----------|------|----------|
| app_provider | åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç† | `app/providers/app_provider.py` |
| database | æ•°æ®åº“è¿æ¥ç®¡ç† | `app/providers/database/__init__.py` |
| exception_provider | å¼‚å¸¸å¤„ç† | `app/providers/exception_provider.py` |
| logging_provider | æ—¥å¿—é…ç½® | `app/providers/logging_provider.py` |

## ğŸŒ ç¯å¢ƒé…ç½®

### é…ç½®ä¼˜å…ˆçº§
1. **ç¯å¢ƒå˜é‡** (æœ€é«˜)
2. **ç¯å¢ƒç‰¹å®šæ–‡ä»¶** (å¦‚ `.env.dev`)
3. **åŸºç¡€é…ç½®æ–‡ä»¶** (`.env`)
4. **ä»£ç é»˜è®¤å€¼** (æœ€ä½)

### ç¯å¢ƒç‰¹ç‚¹
| ç¯å¢ƒ | ç”¨é€” | æ•°æ®åº“æ¨è | è°ƒè¯•æ¨¡å¼ |
|------|------|------------|----------|
| dev | æ—¥å¸¸å¼€å‘ | SQLite/MySQL | âœ… |
| test | è‡ªåŠ¨åŒ–æµ‹è¯• | SQLite (å†…å­˜) | âœ… |
| uat | ç”¨æˆ·éªŒæ”¶æµ‹è¯• | PostgreSQL/MySQL | âŒ |
| prod | ç”Ÿäº§ç¯å¢ƒ | PostgreSQL | âŒ |

## ğŸ”„ ç‰ˆæœ¬æ§åˆ¶

### å¿½ç•¥æ–‡ä»¶
- âœ… **æ•æ„Ÿé…ç½®** - ç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶
- âœ… **ä¸´æ—¶æ–‡ä»¶** - ç¼“å­˜ã€æ—¥å¿—ã€æ•°æ®åº“æ–‡ä»¶
- âœ… **å¼€å‘å·¥å…·** - IDE é…ç½®ã€ç¼–è¯‘äº§ç‰©

### å®‰å…¨å®è·µ
- âœ… **é…ç½®åˆ†ç¦»** - æ•æ„Ÿä¿¡æ¯ä¸å…¥åº“
- âœ… **ç¯å¢ƒéš”ç¦»** - å„ç¯å¢ƒç‹¬ç«‹é…ç½®
- âœ… **å¯†é’¥ç®¡ç†** - ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥æœåŠ¡

## ï¿½ï¿½ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
```bash
git clone <repository>
./setup.sh
make dev
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
export DEPLOY_ENV=prod
make install
make prod-env
```

### Docker éƒ¨ç½²
```bash
make docker-build
make docker-run
```

## ğŸ“ˆ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–° Provider
1. åˆ›å»º `app/providers/new_provider.py`
2. å®ç° `register(app, settings)` å‡½æ•°
3. åœ¨ `bootstrap/application.py` ä¸­æ³¨å†Œ

### æ·»åŠ æ–°ç¯å¢ƒ
1. åˆ›å»º `.env.new_env` é…ç½®æ–‡ä»¶
2. åœ¨ `config/config.py` ä¸­æ·»åŠ ç¯å¢ƒç±»
3. æ›´æ–° `get_settings()` å‡½æ•°

### æ·»åŠ æ–°æ•°æ®åº“
1. å®‰è£…å¯¹åº”çš„å¼‚æ­¥é©±åŠ¨
2. åœ¨ `database/__init__.py` ä¸­æ·»åŠ æ£€æµ‹é€»è¾‘
3. é…ç½®è¿æ¥å‚æ•°å’Œå¥åº·æ£€æŸ¥

---

## ğŸ¯ è®¾è®¡åŸåˆ™

1. **çº¦å®šä¼˜äºé…ç½®** - æä¾›åˆç†çš„é»˜è®¤å€¼
2. **æ¸è¿›å¼å¢å¼º** - åŠŸèƒ½æ¨¡å—åŒ–ï¼ŒæŒ‰éœ€åŠ è½½
3. **å¼€å‘è€…å‹å¥½** - ç®€åŒ–å¸¸ç”¨æ“ä½œï¼Œæä¾›ä¸°å¯Œå·¥å…·
4. **ç”Ÿäº§å°±ç»ª** - è€ƒè™‘æ€§èƒ½ã€å®‰å…¨ã€ç›‘æ§ç­‰ç”Ÿäº§éœ€æ±‚
5. **ç°ä»£åŒ–æ ‡å‡†** - é‡‡ç”¨æœ€æ–°çš„ Python ç”Ÿæ€å®è·µ

è¿™ä¸ªè„šæ‰‹æ¶ä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªsolidçš„åŸºç¡€ï¼Œå¯ä»¥å¿«é€Ÿå¼€å§‹æ‚¨çš„ FastAPI é¡¹ç›®å¼€å‘ï¼ğŸš€
